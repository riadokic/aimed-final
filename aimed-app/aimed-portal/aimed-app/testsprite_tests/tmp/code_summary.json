{
  "tech_stack": ["TypeScript", "Next.js 16", "React 19", "Tailwind CSS v4", "Supabase Auth + SSR", "Framer Motion", "html2pdf.js", "docx", "docxtemplater"],
  "features": [
    {
      "name": "Email/Password Registration",
      "description": "Registration page at /registracija collecting full name, specialization, clinic name, email, and password. Validates password length (8+ chars) and confirmation match. Sends confirmation email on success. Bridges profile data to localStorage.",
      "files": ["src/app/(auth)/registracija/page.tsx", "src/lib/supabase/client.ts", "src/lib/report-storage.ts"]
    },
    {
      "name": "Email/Password Login",
      "description": "Login page at /login with email and password fields. Shows error messages for invalid credentials. Links to registration and password reset pages.",
      "files": ["src/app/(auth)/login/page.tsx", "src/lib/supabase/client.ts"]
    },
    {
      "name": "Google OAuth Authentication",
      "description": "Google sign-in button on login and registration pages. Initiates OAuth flow with PKCE, redirects to /auth/callback which exchanges code for session. Uses access_type=offline and prompt=consent.",
      "files": ["src/components/auth/google-button.tsx", "src/components/auth/auth-provider.tsx", "src/app/auth/callback/route.ts"]
    },
    {
      "name": "Password Reset",
      "description": "Password reset page at /reset-password. Sends reset email via Supabase auth. Shows success confirmation.",
      "files": ["src/app/(auth)/reset-password/page.tsx", "src/lib/supabase/client.ts"]
    },
    {
      "name": "Auth Provider & Session Management",
      "description": "React context providing user state, loading flag, signOut, and signInWithGoogle. Listens for auth state changes via onAuthStateChange. Wraps entire app.",
      "files": ["src/components/auth/auth-provider.tsx", "src/app/layout.tsx"]
    },
    {
      "name": "Route Protection Middleware",
      "description": "Next.js middleware that protects routes. Public paths: /login, /registracija, /reset-password. Redirects unauthenticated users to /login, authenticated users away from auth pages.",
      "files": ["middleware.ts", "src/lib/supabase/middleware.ts"]
    },
    {
      "name": "GDPR Consent Gate",
      "description": "Full-screen blocking consent modal shown after login. Version-aware (v1.0). Must accept before accessing app. Explains data processing (Whisper, Claude, local storage). Decline shows contact info.",
      "files": ["src/components/gdpr/consent-modal.tsx", "src/lib/gdpr.ts"]
    },
    {
      "name": "Settings Page",
      "description": "Settings at /postavke with doctor profile (name, specialty, clinic), Word template upload, app preferences (auto-copy, export format), data export as ZIP, history clearing, GDPR consent review, and complete data deletion with Supabase sign-out.",
      "files": ["src/app/postavke/page.tsx", "src/lib/report-storage.ts", "src/lib/gdpr.ts"]
    },
    {
      "name": "Dashboard",
      "description": "Home page showing stats (daily/monthly/total reports, time saved), recent report history, and quick-action cards.",
      "files": ["src/app/page.tsx", "src/lib/report-storage.ts", "src/lib/analytics.ts"]
    },
    {
      "name": "Medical Report Creation (Novi Nalaz)",
      "description": "Report creation at /novi-nalaz with mode selector (new/update), file upload for updates, audio recording with waveform visualization, AI transcription, section editing, patient data entry, and export.",
      "files": ["src/app/novi-nalaz/page.tsx", "src/components/recording/dictation-flow.tsx", "src/components/recording/live-waveform.tsx", "src/hooks/use-audio-recorder.ts", "src/hooks/use-aimed-api.ts"]
    },
    {
      "name": "Report History",
      "description": "History at /historija with date grouping, search filtering, period filters, export to PDF/Word, and delete functionality.",
      "files": ["src/app/historija/page.tsx", "src/lib/report-storage.ts"]
    },
    {
      "name": "Document Export (PDF/Word)",
      "description": "PDF generation via html2pdf.js and Word via docx/docxtemplater. Supports template-based and programmatic generation. Concurrent exports with loading states.",
      "files": ["src/hooks/use-aimed-export.ts", "src/lib/pdf-generator.ts", "src/lib/word-generator.ts"]
    },
    {
      "name": "API Route - Submit",
      "description": "POST /api/submit receives audio + form data, verifies Supabase session, forwards to n8n webhook with Bearer token, sanitizes errors.",
      "files": ["src/app/api/submit/route.ts", "src/services/aimed-api.ts"]
    },
    {
      "name": "API Route - Export",
      "description": "POST /api/export receives report data, verifies Supabase session, forwards to n8n for document generation, handles binary (PDF) and JSON (Word) responses.",
      "files": ["src/app/api/export/route.ts"]
    },
    {
      "name": "App Shell & Layout",
      "description": "Conditional layout: auth pages render without sidebar, authenticated pages get sidebar + consent gate. Responsive sidebar with mobile drawer.",
      "files": ["src/components/layout/app-shell.tsx", "src/components/layout/sidebar.tsx", "src/components/layout/header.tsx", "src/components/layout/page-container.tsx"]
    },
    {
      "name": "Supabase Database Integration",
      "description": "Profiles and doctor_settings tables with RLS policies. Auto-profile creation trigger on signup. TypeScript types generated from schema.",
      "files": ["src/types/supabase.ts", "src/lib/supabase/client.ts", "src/lib/supabase/server.ts"]
    }
  ]
}
